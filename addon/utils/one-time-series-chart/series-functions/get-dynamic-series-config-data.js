/**
 * A series function, which allows accessing dynamic config of a series. It can
 * be used only in series generated by `dynamic` series factory.
 *
 * Arguments:
 * - `propertyName` (string) name of a property, which should be extracted from the
 *   dynamic config. If not provided, the whole dynamic config object will be returned.
 *   If `propertyName` cannot be found in dynamic config, null will be returned.
 *
 * @module utils/one-time-series-chart/series-functions/get-dynamic-series-config-data
 * @author Michał Borzęcki
 * @copyright (C) 2022 ACK CYFRONET AGH
 * @license This software is released under the MIT license cited in 'LICENSE.txt'.
 */

/**
 * @typedef {Object} OTSCGetDSCDataSeriesFunctionArguments
 * @property {string} [propertyName]
 */

/**
 * @param {OTSCSeriesFunctionContext} context
 * @param {OTSCGetDSCDataSeriesFunctionArguments} args
 * @returns {Promise<OTSCSeriesFunctionBasicResult<unknown>>}
 */
export default async function getDynamicSeriesConfigData(context, args) {
  let data = null;
  if ('dynamicSeriesConfig' in context) {
    const config = context.dynamicSeriesConfig;
    if (!args || !args.propertyName) {
      data = config;
    } else if (
      typeof config === 'object' &&
      config &&
      args.propertyName in config
    ) {
      data = config[args.propertyName];
    }
  }

  return {
    type: 'basic',
    data,
  };
}
